using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GameConsoles1
{
    internal class Program
    {
        static void Main()
        {
            bool isWork = true;
            Shop shop = new Shop();
            shop.AddProducts();
            Salesman salesman = new Salesman(shop.GiveAwayGoods());
            Player player = new Player();
            

            while (isWork)
            {
                player.ShowInfo();
                salesman.SwhoInfo();
                shop.PurchaseVerification(player, salesman);

            }

        }
    }
    
    class Shop
    {
       private List<Product> _products = new List<Product> ();

        public Shop()
        {
            
        }
       public void AddProducts()
        {
            int numberId = 0;
            _products.Add(new Product(numberId++, "Меч",100));
            _products.Add(new Product(numberId++, "Лук", 200));
            _products.Add(new Product(numberId++, "Щит", 400));
            _products.Add(new Product(numberId++, "Паприка", 30));
        }

        public void SwhoInfo()
        {
            for (int i = 0; i < _products.Count; i++)
            {
                _products[i].ShowInfo();
            }
        }

        public List<Product> GiveAwayGoods()
        {
            return _products;
        }

        public void PurchaseVerification(Player player, Salesman salesman)
        {
            Product product = salesman.GetProduct();

            if (product != null && player.Money - product.Price >= 0)
            {
                player.Money -= product.Price;
                salesman.Cash += product.Price;
                player.ByProduts(product);
                Remov(product);
                Console.Clear();
            }
            else
            {
                Console.Clear();
                Console.WriteLine("Не достаточно средств");
            }
            
        }

        public void Remov(Product sellProduct)
        {
            for (int i = 0; i < _products.Count; i++)
            {
                if (sellProduct == _products[i])
                {
                    _products.Remove(sellProduct);
                }
            }
        }
    }

     class Product 
    {
       private int _id;
       private string _name;
       private int _price;
       public int Price => _price;
       public int Id => _id;

       public Product(int id ,string name,int price)
       {
            _id  = id;
            _name = name;
            _price = price;
       }

        public void ShowInfo()
        {
            Console.WriteLine($"{_id} - {_name} - {_price}");
        }
    }

    class Salesman
    {
        List<Product> _products;
        private int _cash = 0;
        public int Cash
        {
            get
            {
                return _cash;
            }
            set
            {
                _cash = value;
            } 
        }
        
        public Salesman(List<Product> products)
        {
            _products = products;
        }

        public void SwhoInfo()
        {
            Console.WriteLine($"Баланс продовца - {_cash}");
            for (int i = 0; i < _products.Count; i++)
            {
                _products[i].ShowInfo();
            }
        }

        public Product GetProduct()
        {
            Console.WriteLine("Выберете номер продкута");
            string userNumber = Console.ReadLine();
            if(int.TryParse(userNumber,out int userId))
            {
                for (int i = 0; i < _products.Count; i++)
                {
                    if (userId == _products[i].Id)
                    {
                         return _products[i];
                        
                    }
                }
            }
            return null;
        }
    }

    class Player
    {
       private List<Product> _byProducts = new List<Product> ();
       private int _money = 600;
       
       public int Money { get { return _money; }set { _money = value; } }

       public Player()
        {

        }

        public void ByProduts(Product product)
        {
            if (product != null)
            {
                _byProducts.Add(product);
            }
        }

        public void ShowInfo()
        {
            Console.WriteLine("Покупки");
            for (int i = 0; i < _byProducts.Count; i++)
            {
                _byProducts[i].ShowInfo();
            }
            Console.WriteLine($"{Money}");
        }
    }
}
