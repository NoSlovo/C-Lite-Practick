using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GameConsoles1
{
    internal class Program
    {
        static void Main()
        {

            bool isWork = true;
            List<Product> products = new List<Product>();
            Shop shop = new Shop(products);
            Salesman salesman = new Salesman(products);
            Player player = new Player();
            salesman.AddProduct("Меч",400);
            salesman.AddProduct("Лук",200);
            salesman.AddProduct("Щит",100);
            salesman.AddProduct("Паприка",10);

            while (isWork)
            {
                shop.DisplayList();
                player.ShowInfo();
                string numbeUser = Console.ReadLine();
                Console.Clear();
                if (int.TryParse(numbeUser, out int userId))
                {
                    salesman.GetProduct(userId);
                    player.AddProduct(salesman.GetProduct(userId));
                    shop.Remove(salesman.GetProduct(userId),player);
                }
                else
                {
                    Console.WriteLine("Что-то пошло не так");
                }
            }     
        }
    }
    
    class Shop
    {
        private List<Product> _products = new List<Product>();

        public Shop(List<Product> products)
        {
            _products = products;
        }


        public void Remove(Product product, Player player)
        {
            if (product.Prise <= player.Money)
            {
                _products.Remove(product);
            }

        }

        public void DisplayList()
        {
            Console.WriteLine("Список товаров:");
            foreach (Product product in _products)
            {
                product.ShowInfo();
            }

            Console.WriteLine("Что хотите приобрести?");
            Console.WriteLine();
        }
    }

     class Product 
    {
        private static int _ids;
        private int _id;
        private string _name;
        private int _prise;

        public int Id => _id;
        public int Prise => _prise;

        public Product(string name,int price)
        {
            _id = _ids++;
            _name = name;
            _prise = price;
        }

        public void ShowInfo()
        {
            Console.WriteLine($"{_id} - {_name} - {_prise} ");
        }
    }

    class Salesman:Shop
    {
        private List<Product> _products = new List<Product>();
        public Salesman(List<Product> products) : base(products)
        {
            
            _products = products;
        }

        public void AddProduct(string name, int money)
        {
            _products.Add(new Product(name,money));
        }

        
        
        public Product GetProduct(int userNumber)
        {
            for (int i = 0; i < _products.Count;i++)
            {
                if (userNumber  == _products[i].Id)
                { 
                    return _products[i];
                }      
            }
            return null;
        }
    }

    class Player
    {
        private List<Product> _userProduct;
        private int _money = 600;

        public int Money { get { return _money; } private set { _money = value; } }

        public Player()
        {
            _userProduct = new List<Product>();
        }

        public void AddProduct(Product product)
        {
            if (Money >= product.Prise)
            {
                Money -= product.Prise;
                _userProduct.Add(product);
            }
            else
            {
                Console.WriteLine("Недостаточно средств");
            }
            Console.WriteLine($" У игрока {Money} золотых");
        }

        public void ShowInfo()
        {
            Console.WriteLine("Покупки игрока");
            for (int i = 0; i < _userProduct.Count; i++)
            {
                _userProduct[i].ShowInfo();
            }
        }
    }
}
